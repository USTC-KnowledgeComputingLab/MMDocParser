# MMDocParser

ä¸€ä¸ªä¸“ä¸šçš„æ–‡æ¡£è§£ææœåŠ¡ï¼Œæ”¯æŒæå–æ–‡æ¡£ä¸­çš„æ–‡å­—ã€å›¾ç‰‡ã€è¡¨æ ¼ã€å…¬å¼ç­‰ä¿¡æ¯ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸš€ **å¼‚æ­¥å¤„ç†**ï¼šåŸºäºSanicçš„é«˜æ€§èƒ½å¼‚æ­¥Webæ¡†æ¶
- ğŸ“ **å¤šæ ¼å¼æ”¯æŒ**ï¼šPDFã€DOCXã€PPTXã€XLSXã€å›¾ç‰‡ç­‰
- ğŸ”„ **ä»»åŠ¡é˜Ÿåˆ—**ï¼šRedisä»»åŠ¡é˜Ÿåˆ—ï¼Œæ”¯æŒå¼‚æ­¥å¤„ç†
- â˜ï¸ **äº‘å­˜å‚¨**ï¼šS3å…¼å®¹å­˜å‚¨ï¼Œæ”¯æŒå¤§æ–‡ä»¶
- ğŸ“Š **çŠ¶æ€è·Ÿè¸ª**ï¼šå®æ—¶æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€å’Œç»“æœ
- ğŸ¥ **å¥åº·æ£€æŸ¥**ï¼šæœåŠ¡å¥åº·çŠ¶æ€ç›‘æ§

## æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å®¢æˆ·ç«¯å±‚      â”‚    â”‚   APIç½‘å…³å±‚     â”‚    â”‚   æœåŠ¡å±‚        â”‚
â”‚  (Web/ç§»åŠ¨ç«¯)   â”‚â”€â”€â”€â–¶â”‚  (Sanic)        â”‚â”€â”€â”€â–¶â”‚  (æ–‡æ¡£è§£æ)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚                       â”‚
                                â–¼                       â–¼
                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                       â”‚   é˜Ÿåˆ—å±‚        â”‚    â”‚   å­˜å‚¨å±‚        â”‚
                       â”‚  (Redis)        â”‚    â”‚  (S3)          â”‚
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒè¦æ±‚

- Python 3.12+
- Redis 6.0+
- S3å…¼å®¹å­˜å‚¨ï¼ˆMinIO/AWS S3ï¼‰

### 2. å®‰è£…ä¾èµ–

```bash
# ä½¿ç”¨uvå®‰è£…
uv sync

# æˆ–ä½¿ç”¨pip
pip install -r requirements.txt
```

### 3. é…ç½®ç¯å¢ƒå˜é‡

```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿
cp .env.example .env

# ç¼–è¾‘é…ç½®
export REDIS_URL="redis://localhost:6379"
export S3_ENDPOINT="http://localhost:9000"
export S3_ACCESS_KEY="minioadmin"
export S3_SECRET_KEY="minioadmin"
export S3_BUCKET="documents"
```

### 4. å¯åŠ¨æœåŠ¡

```bash
# æ–¹å¼1ï¼šä½¿ç”¨å¯åŠ¨è„šæœ¬
python run.py

# æ–¹å¼2ï¼šç›´æ¥è¿è¡Œ
sanic main:app --host 0.0.0.0 --port 8000 --workers 4
```

## APIæ¥å£

### 1. ä¸Šä¼ æ–‡æ¡£

```http
POST /api/v1/documents/upload
Content-Type: application/json

{
  "files": [
    {
      "name": "document.pdf",
      "content": "base64ç¼–ç çš„æ–‡ä»¶å†…å®¹"
    }
  ],
  "template_type": "åŒ–å­¦",
  "task_type": "document_analysis"
}
```

### 2. æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€

```http
GET /api/v1/tasks/{task_id}/status
```

### 3. è·å–è§£æç»“æœ

```http
GET /api/v1/tasks/{task_id}/result
```

### 4. å¥åº·æ£€æŸ¥

```http
GET /health
```

## é¡¹ç›®ç»“æ„

```
MMDocParser/
â”œâ”€â”€ main.py                 # ä¸»åº”ç”¨æ–‡ä»¶
â”œâ”€â”€ run.py                  # å¯åŠ¨è„šæœ¬
â”œâ”€â”€ config.py               # é…ç½®ç®¡ç†
â”œâ”€â”€ storage/                # å­˜å‚¨ç›¸å…³
â”‚   â”œâ”€â”€ s3_client.py       # S3å®¢æˆ·ç«¯
â”‚   â””â”€â”€ redis_client.py    # Rediså®¢æˆ·ç«¯
â”œâ”€â”€ parsers/                # æ–‡æ¡£è§£æå™¨
â”‚   â””â”€â”€ document_parser.py # è§£æå™¨åŸºç±»å’Œå®ç°
â”œâ”€â”€ utils/                  # å·¥å…·å‡½æ•°
â”‚   â””â”€â”€ validators.py      # éªŒè¯å·¥å…·
â””â”€â”€ pyproject.toml         # é¡¹ç›®é…ç½®
```

## å¼€å‘æŒ‡å—

### æ·»åŠ æ–°çš„æ–‡æ¡£æ ¼å¼æ”¯æŒ

1. åœ¨ `parsers/document_parser.py` ä¸­åˆ›å»ºæ–°çš„è§£æå™¨ç±»
2. ç»§æ‰¿ `DocumentParser` åŸºç±»
3. å®ç° `parse()` å’Œ `can_parse()` æ–¹æ³•
4. åœ¨ `DocumentParserFactory` ä¸­æ³¨å†Œæ–°è§£æå™¨

### è‡ªå®šä¹‰å­˜å‚¨åç«¯

1. å®ç°ä¸ `AsyncS3Client` ç›¸åŒçš„æ¥å£
2. åœ¨ `main.py` ä¸­æ›¿æ¢å­˜å‚¨å®¢æˆ·ç«¯
3. æ›´æ–°é…ç½®æ–‡ä»¶

## éƒ¨ç½²

### Dockeréƒ¨ç½²

```dockerfile
FROM python:3.12-slim

WORKDIR /app
COPY requirements.txt .
RUN pip install -r requirements.txt

COPY . .
EXPOSE 8000

CMD ["python", "run.py"]
```

### ç”Ÿäº§ç¯å¢ƒé…ç½®

```bash
# ç”Ÿäº§ç¯å¢ƒå˜é‡
export HOST="0.0.0.0"
export PORT="8000"
export WORKERS="8"
export REDIS_URL="redis://redis:6379"
export S3_ENDPOINT="https://s3.amazonaws.com"
```

## æ€§èƒ½ä¼˜åŒ–

- æ–‡ä»¶ä¸Šä¼ ï¼šå¹¶å‘ä¸Šä¼ åˆ°S3
- æ–‡æ¡£è§£æï¼šä¸²è¡Œå¤„ç†ï¼Œé¿å…èµ„æºç«äº‰
- ç»“æœå­˜å‚¨ï¼šå¹¶å‘å†™å…¥ï¼Œæå‡å“åº”é€Ÿåº¦

## ç›‘æ§å’Œæ—¥å¿—

- ç»“æ„åŒ–æ—¥å¿—è®°å½•
- å¥åº·æ£€æŸ¥æ¥å£
- ä»»åŠ¡çŠ¶æ€è·Ÿè¸ª
- é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶

## è®¸å¯è¯

MIT License

## è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestï¼

